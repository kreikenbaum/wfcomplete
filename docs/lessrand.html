<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <title>
      #8470 (Request randomization a lot less random in FF17)
     – Tor Bug Tracker &amp; Wiki
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="https://trac.torproject.org/projects/tor/search">
        <link rel="prev" href="https://trac.torproject.org/projects/tor/ticket/8469" title="Ticket #8469">
        <link rel="last" href="https://trac.torproject.org/projects/tor/ticket/17143" title="Ticket #17143">
        <link rel="help" href="https://trac.torproject.org/projects/tor/wiki/TracGuide">
        <link rel="alternate" href="https://trac.torproject.org/projects/tor/ticket/8470?format=csv" type="text/csv" class="csv" title="Comma-delimited Text"><link rel="alternate" href="https://trac.torproject.org/projects/tor/ticket/8470?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text"><link rel="alternate" href="https://trac.torproject.org/projects/tor/ticket/8470?format=rss" type="application/rss+xml" class="rss" title="RSS Feed">
        <link rel="tracwysiwyg.base" href="https://trac.torproject.org/projects/tor">
        <link rel="next" href="https://trac.torproject.org/projects/tor/ticket/8471" title="Ticket #8471">
        <link rel="start" href="https://trac.torproject.org/projects/tor/wiki">
        <link rel="stylesheet" href="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/trac.css" type="text/css"><link rel="stylesheet" href="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/ticket.css" type="text/css"><link rel="stylesheet" href="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/wysiwyg.css" type="text/css"><link rel="stylesheet" href="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/childtickets.css" type="text/css">
        <link rel="tracwysiwyg.stylesheet" href="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/trac.css"><link rel="tracwysiwyg.stylesheet" href="https://trac.torproject.org/projects/tor/chrome/tracwysiwyg/editor.css">
        <link rel="first" href="https://trac.torproject.org/projects/tor/ticket/2" title="Ticket #2">
        <link rel="shortcut icon" href="https://trac.torproject.org/images/favicon.ico" type="image/x-icon">
        <link rel="icon" href="https://trac.torproject.org/images/favicon.ico" type="image/x-icon">
      <link type="application/opensearchdescription+xml" rel="search" href="https://trac.torproject.org/projects/tor/search/opensearch" title="Search Tor Bug Tracker &amp; Wiki">
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="af29fda1ced7b8c7ab27eea0";
      var _tracwysiwyg={"escapeNewlines":true};
      var comments_prefs={"comments_only":"false","comments_order":"oldest"};
    </script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/en_US.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/folding.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/wikitoolbar.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/resizer.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/auto_preview.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/wysiwyg.js"></script>
      <script type="text/javascript" charset="utf-8" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/wysiwyg-load.js"></script>
    <script type="text/javascript" src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/threaded_comments.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
      /*<![CDATA[*/
        $("#attachments").toggleClass("collapsed");
        $("#trac-up-attachments").click(function () {
          $("#attachments").removeClass("collapsed");
          return true;
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
        function setRevertHandler() {
          $("button.trac-revert").click(function() {
            var div = $("div", this);
            var field_name = div[0].id.substr(7);
            var field_value = div.text();
            var input = $("#propertyform *[name=field_" + field_name + "]");
            if (input.length > 0) {
              if (input.filter("input[type=radio]").length > 0) {
                input.val([field_value]);
              } else if (input.filter("input[type=checkbox]").length > 0) {
                input.val(field_value == "1" ? [field_value] : []);
              } else {
                input.val(field_value);
              }
            } else { // Special case for CC checkbox
              input = $("#propertyform input[name=cc_update]").val([]);
            }
            input.change();
            $(this).closest("li").remove();
            return false;
          });
        }
        setRevertHandler();
        var comment_focused = false;
        $("#comment").focus(function() { comment_focused = true; })
                     .blur(function() { comment_focused = false; });
        $("#propertyform").autoSubmit({preview: '1'}, function(data, reply) {
          var items = $(reply);
          // Update ticket box
          $("#ticket").replaceWith(items.filter('#ticket'));
          // Unthread, unrevert and update changelog
          if (!$('#trac-comments-oldest').checked())
            $('#trac-comments-oldest').click().change();
          $("#changelog").replaceWith(items.filter("#changelog"));
          if ($('#trac-comments-only-toggle').attr('checked'))
            $('#trac-comments-only-toggle').click().attr('checked', true);
          // Show warning
          var new_changes = $("#changelog .trac-new");
          $("#trac-edit-warning").toggle(new_changes.length != 0);
          if (new_changes.length != 0)
            $("#changelog").parent().show().removeClass("collapsed");
          // Update view time
          $("#propertyform input[name='view_time']").replaceWith(items.filter("input[name='view_time']"));
          // Update preview
          var preview = $("#ticketchange").html(items.filter('#preview').children());
          var show_preview = preview.children().length != 0;
          $("#ticketchange").toggle(show_preview);
          setRevertHandler();
          // Collapse property form if comment editor has focus
          if (show_preview && comment_focused)
            $("#modify").parent().addClass("collapsed");
        }, "#ticketchange .trac-loading");
        $("#trac-comment-editor").autoSubmit({preview_comment: '1'}, function(data, reply) {
          var comment = $("#trac-comment-editor").next("div.comment").html(reply);
          comment.toggle(comment.children().length != 0);
        }, "#changelog .trac-loading");
        /*]]>*/
      });
    </script>
    <link rel="stylesheet" type="text/css" href="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/tor.css">
  </head>
  <body>
    <div id="siteheader">
    </div>
    <div id="banner">
      <div id="header">
        <a id="logo" href="https://trac.torproject.org/"><img src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/tor-logo.png" alt="The Tor Project"></a>
      </div>
      <form id="search" action="/projects/tor/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input id="proj-search" name="q" size="18" type="text">
          <input value="Search" type="submit">
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="https://trac.torproject.org/projects/tor/login">Login</a></li><li><a href="https://trac.torproject.org/projects/tor/prefs">Preferences</a></li><li><a href="https://trac.torproject.org/projects/tor/wiki/TracGuide">Help/Guide</a></li><li><a href="https://trac.torproject.org/projects/tor/about">About Trac</a></li><li class="last"><a href="https://trac.torproject.org/projects/tor/register">Register</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="https://trac.torproject.org/projects/tor/report">View Tickets</a></li><li><a href="https://trac.torproject.org/projects/tor/browser">Browse Source</a></li><li><a href="https://trac.torproject.org/projects/tor/roadmap">Roadmap</a></li><li><a href="https://trac.torproject.org/projects/tor/timeline">Timeline</a></li><li><a href="https://trac.torproject.org/projects/tor/wiki">Wiki</a></li><li><a href="https://trac.torproject.org/projects/tor/search">Search</a></li><li class="last"><a href="https://trac.torproject.org/projects/tor/tags">Tags</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><span>← <a class="prev" href="https://trac.torproject.org/projects/tor/ticket/8469" title="Ticket #8469">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="https://trac.torproject.org/projects/tor/ticket/8471" title="Ticket #8471">Next Ticket</a> →</span></li>
        </ul>
        <hr>
      </div>
    <div id="content" class="ticket">
        <div id="ticket" class="trac-content ">
  <div class="date">
    <p>Opened <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-03-14T01%3A24%3A48Z&amp;precision=second" title="See timeline at Mar 14, 2013 1:24:48 AM">3 years ago</a></p>
    <p>Closed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-04-25T00%3A25%3A55Z&amp;precision=second" title="See timeline at Apr 25, 2013 12:25:55 AM">2 years ago</a></p>
  </div>
  <h2>
    <a href="https://trac.torproject.org/projects/tor/ticket/8470" class="trac-id">#8470</a>
    <span class="trac-status">
      <a href="https://trac.torproject.org/projects/tor/query?status=closed">closed</a>
    </span>
    <span class="trac-type">
      <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;type=defect">defect</a>
    </span>
    <span class="trac-resolution">
      (<a href="https://trac.torproject.org/projects/tor/query?status=closed&amp;resolution=fixed">fixed</a>)
    </span>
  </h2>
  <h1 id="trac-ticket-title" class="searchable">
    <span class="summary">Request randomization a lot less random in FF17</span>
  </h1>
  <table class="properties">
    <tbody><tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable"><a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;reporter=mikeperry">mikeperry</a></td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner"><a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;owner=mikeperry">mikeperry</a></td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;priority=critical">critical</a>
        </td>
        <th id="h_milestone" class="missing">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="missing milestone"></a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;component=Firefox+Patch+Issues">Firefox Patch Issues</a>
        </td>
        <th id="h_version" class="missing">
          Version:
        </th>
        <td headers="h_version">
              <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;version="></a>
        </td>
    </tr><tr>
        <th id="h_keywords">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
              <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;keywords=%7Etbb-rebase-regression">tbb-rebase-regression</a>, <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;keywords=%7EMikePerry201304">MikePerry201304</a>
        </td>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
              <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;cc=%7Et55wang">t55wang</a>, <a href="https://trac.torproject.org/projects/tor/query?status=%21closed&amp;cc=%7Emcs">mcs</a>
        </td>
    </tr><tr>
        <th id="h_actualpoints">
          Actual Points:
        </th>
        <td headers="h_actualpoints">
              26
        </td>
        <th id="h_parent" class="missing">
          Parent ID:
        </th>
        <td headers="h_parent">
        </td>
    </tr><tr>
        <th id="h_points" class="missing">
          Points:
        </th>
        <td headers="h_points">
        </td>
        <th class="missing">
        </th>
        <td>
        </td>
    </tr>
  </tbody></table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <p>
I decided to take a closer look at the actual request ordering in our 
Firefox builds, and it appears a lot less random than when I first 
tested the pipeline randomization patch.<br>
</p>
<p>
This could be due to a regression before FF10, since the last time I 
tested it was ~FF7/8, but most likely it was introduced between 10 and 
17, when I rewrote the patch completely.<br>
</p>

    </div>
  </div>
</div><div><h2 class="foldable">Child Tickets</h2><div id="childtickets"><div></div><div></div></div></div>
          
    <div id="attachments">
        <h3 class="foldable">Attachments <span class="trac-count">(1)</span></h3>
        <div class="attachments">
          <dl class="attachments">
              <dt>
    <a href="https://trac.torproject.org/projects/tor/attachment/ticket/8470/IncreaseRandomization.diff" title="View attachment">IncreaseRandomization.diff</a><a href="https://trac.torproject.org/projects/tor/raw-attachment/ticket/8470/IncreaseRandomization.diff" class="trac-rawlink" title="Download">​</a>
       (<span title="3536 bytes">3.5 KB</span>) -
      added by <em>mikeperry</em> <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-03-29T21%3A52%3A01Z&amp;precision=second" title="See timeline at Mar 29, 2013 9:52:01 PM">2 years ago</a>.
  </dt>
              <dd>
                Some potential ideas.
              </dd>
          </dl>
          <p>
            Download all attachments as: <a rel="nofollow" href="https://trac.torproject.org/projects/tor/zip-attachment/ticket/8470/">.zip</a>
          </p>
          
        </div>
    </div>

        <div>
          <div style="position: relative">
            <form id="prefs" method="get" action="/projects/tor/prefs" style="position: absolute; right: 0">
              <div id="trac-comments-order">
                <input id="trac-comments-oldest" name="trac-comments-order" value="oldest" checked="checked" type="radio">
                <label for="trac-comments-oldest">Oldest first</label>
                <input id="trac-comments-newest" name="trac-comments-order" value="newest" type="radio">
                <label for="trac-comments-newest">Newest first</label>
                <span id="trac-threaded-toggle" style="display: none">
                  <input id="trac-comments-threaded" name="trac-comments-order" value="threaded" type="radio">
                  <label for="trac-comments-threaded">Threaded</label>
                </span>
              </div>
              <div>
                <input id="trac-comments-only-toggle" type="checkbox">
                <label for="trac-comments-only-toggle">Comments only</label>
              </div>
            </form>
          </div>
          <h3 class="foldable">Change History <span class="trac-count">(9)</span></h3>
          <div id="changelog">
              <div class="change" id="trac-change-1-1364328402000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:1" class="cnum">
    <a href="#comment:1">comment:1</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-03-26T20%3A06%3A42Z&amp;precision=second" title="See timeline at Mar 26, 2013 8:06:42 PM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
The Firefox 10 implementation can still be found here: <a class="ext-link" href="https://gitweb.torproject.org/torbrowser.git/blob/maint-2.2:/src/current-patches/firefox/0017-Randomize-HTTP-request-order-and-pipeline-depth.patch"><span class="icon">​</span>https://gitweb.torproject.org/torbrowser.git/blob/maint-2.2:/src/current-patches/firefox/0017-Randomize-HTTP-request-order-and-pipeline-depth.patch</a>.<br>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2-1364328562000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:2" class="cnum">
    <a href="#comment:2">comment:2</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-03-26T20%3A09%3A22Z&amp;precision=second" title="See timeline at Mar 26, 2013 8:09:22 PM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-priority">
      <strong class="trac-field-priority">Priority</strong>
        changed from <em>major</em> to <em>critical</em>
    </li>
  </ul>
    <div class="comment searchable">
      <p>
I'm going to call this critical, since it is important that researchers study a functional defense.<br>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3-1364588471000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:3" class="cnum">
    <a href="#comment:3">comment:3</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-03-29T20%3A21%3A11Z&amp;precision=second" title="See timeline at Mar 29, 2013 8:21:11 PM">2 years ago</a> by mcs
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-cc">
      <strong class="trac-field-cc">Cc</strong>
        <em>mcs</em> added
    </li>
  </ul>

              </div>
              <div class="change" id="trac-change-4-1364593867000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:4" class="cnum">
    <a href="#comment:4">comment:4</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-03-29T21%3A51%3A07Z&amp;precision=second" title="See timeline at Mar 29, 2013 9:51:07 PM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
mcs: FYI I did some investigation into this the other day. Attaching a patch with some ideas. Haven't tested it yet.<br>
</p>

    </div>

              </div>
              <div class="change">
                
  <h3 class="change">
    <span class="threading">
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-03-29T21%3A52%3A01Z&amp;precision=second" title="See timeline at Mar 29, 2013 9:52:01 PM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-attachment">
      <strong class="trac-field-attachment">Attachment</strong>
        <a href="https://trac.torproject.org/projects/tor/attachment/ticket/8470/IncreaseRandomization.diff"><em>IncreaseRandomization.diff</em></a><a href="https://trac.torproject.org/projects/tor/raw-attachment/ticket/8470/IncreaseRandomization.diff" title="Download" class="trac-rawlink">​</a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      <p>
Some potential ideas.<br>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5-1364864820000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:5" class="cnum">
    <a href="#comment:5">comment:5</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-04-02T01%3A07%3A00Z&amp;precision=second" title="See timeline at Apr 2, 2013 1:07:00 AM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-keywords">
      <strong class="trac-field-keywords">Keywords</strong>
        <em>MikePerry201304</em> added
    </li>
  </ul>

              </div>
              <div class="change" id="trac-change-6-1365457501000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:6" class="cnum">
    <a href="#comment:6">comment:6</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-04-08T21%3A45%3A01Z&amp;precision=second" title="See timeline at Apr 8, 2013 9:45:01 PM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Ok, I've been testing that patch with a debug build + logs for a bit. 
I've discovered that quite a few of the pipeline connections are hitting
 the hardcoded timeout of 1.5 seconds and getting rescheduled. This 
might not be too bad, because it should just create more opportunities 
for randomization, *except* that the code also marks connections that 
timeout as unsuitable for future pipelining. Once the connection limit 
is hit, pipelining then stops entirely.<br>
</p>
<p>
So in effect, for large websites, pipelinining is almost completely 
disabled for Tor by this timeout. It looks like this specific 
pref+variable were a new addition to the FF17 code during the pipelining
 rewrite, but there may have been an analog to this timer in FF10 and 
before...<br>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7-1365553365000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:7" class="cnum">
    <a href="#comment:7">comment:7</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-04-10T00%3A22%3A45Z&amp;precision=second" title="See timeline at Apr 10, 2013 12:22:45 AM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
It turns out that pipeline behavior is significantly different in debug 
vs non-debug builds. In debug builds (especially if debug logs are 
enabled), the browser is often too slow to be able to keep the pipeline 
full of requests, and requests aren't packed together in Tor cells.<br>
</p>
<p>
This might be important, because it may also be the case that a browser 
that is driven around by selenium in a VM might be similarly too slow 
for pipelining's request combining to happen.<br>
</p>
<p>
I'll be updating the pipeline patch to have an option to log the 
pipeline state as requests are sent separately from debug logs to help 
diagnose this.<br>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8-1366849555000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:8" class="cnum">
    <a href="#comment:8">comment:8</a>
  </span>
    </span>
        Changed <a class="timeline" href="https://trac.torproject.org/projects/tor/timeline?from=2013-04-25T00%3A25%3A55Z&amp;precision=second" title="See timeline at Apr 25, 2013 12:25:55 AM">2 years ago</a> by mikeperry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-actualpoints">
      <strong class="trac-field-actualpoints">Actual Points</strong>
        set to <em>26</em>
    </li><li class="trac-field-resolution">
      <strong class="trac-field-resolution">Resolution</strong>
        set to <em>fixed</em>
    </li><li class="trac-field-status">
      <strong class="trac-field-status">Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      <p>
I put quite a bit of work into this, and I'm fairly satisfied that the 
new patch in origin/maint-2.4 is at least a good improvement. The basic 
idea is to restrict new connection creation until we have enough 
requests to batch together (governed by a pref) in a new pipeline.<br>
</p>
<p>
Read the patch description for more details:<br>
<a class="ext-link" href="https://gitweb.torproject.org/torbrowser.git/blob/maint-2.4:/src/current-patches/firefox/0017-Randomize-HTTP-request-order-and-pipeline-depth.patch"><span class="icon">​</span>https://gitweb.torproject.org/torbrowser.git/blob/maint-2.4:/src/current-patches/firefox/0017-Randomize-HTTP-request-order-and-pipeline-depth.patch</a><br>
</p>
<p>
The patch still does not deal with SPDY directly.<br>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="https://trac.torproject.org/projects/tor/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="https://trac.torproject.org/projects/tor/ticket/8470?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="https://trac.torproject.org/projects/tor/ticket/8470?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="https://trac.torproject.org/projects/tor/ticket/8470?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" xml:lang="en" lang="en"><hr>
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="%238470%20%28Request%20randomization%20a%20lot%20less%20random%20in%20FF17%29%20%E2%80%93%20Tor%20Bug%20Tracker%20&amp;%20Wiki_files/trac_logo_mini.png" alt="Trac Powered" height="30" width="107"></a>
      <p class="left">Powered by <a href="https://trac.torproject.org/projects/tor/about"><strong>Trac 1.0.1</strong></a><br>
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Tor project at<br><a href="https://www.torproject.org/">https://www.torproject.org/</a></p>
    </div>
    <div id="sitefooter">
    </div>
  
</body></html>